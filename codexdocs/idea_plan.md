# AI 에이전트 협업 메신저 기획 문서 (v0.2, Codex CLI MVP)

## 1. 제품 한 줄 정의
슬랙형 협업 메신저에 "모든 멤버가 AI 에이전트"라는 구조를 결합해, 대화와 작업 실행이 한 공간에서 이어지는 AI 팀 운영 앱.

## 2. 문제 정의
- 기존 협업툴은 "사람 간 소통" 중심이라, 실제 실행(문서 작성, 리서치, 개발, 보고)으로 넘어갈 때 컨텍스트가 끊김.
- AI를 개별 툴로 쓰면 히스토리와 책임 주체가 분산되어 업무 추적이 어려움.
- 팀 단위 자동화를 하려면 역할별 AI를 지속적으로 운영/관찰할 수 있는 인터페이스가 필요함.

## 3. 목표 / 비목표
### 목표
- 채팅 기반으로 AI 에이전트를 생성, 배치, 지시, 추적할 수 있게 한다.
- DM(1:1)과 채널(다자) 모두에서 작업 지시와 결과 공유가 자연스럽게 이어지게 한다.
- "누가 무엇을 언제까지 하는지"가 메시지 맥락 안에서 명확하게 보이게 한다.
- MVP에서는 앱 자체 OAuth 없이, 로컬에 로그인된 Codex CLI 세션으로 에이전트를 실행한다.

### 비목표 (MVP 기준)
- 외부 고객용 메신저(오픈 채팅, 대규모 커뮤니티) 기능
- 음성/화상 회의
- 복잡한 조직도/결재 워크플로우

## 4. 타겟 사용자
- 1차: 소규모 스타트업/1인 창업자/프로덕트 팀
- 2차: 에이전시, 콘텐츠 팀, 리서치 팀

## 5. 핵심 가치 제안
- 역할 기반 AI 팀 구성: PM, 디자이너, 개발자, 마케터 같은 에이전트를 즉시 생성
- 대화 + 실행 통합: 메시지에서 바로 업무 할당/상태 변경/결과 확인
- 투명한 협업 로그: DM과 채널 모두에서 실행 이력과 결정 맥락 보존

## 6. UX 방향 (Slack 구조 + Notion 감성)
### UX 구조 (Slack 스타일)
- 좌측 사이드바: 워크스페이스, DM, 채널, 멤버 목록
- 중앙 패널: 대화 타임라인
- 우측 패널: 멤버/작업/컨텍스트(문서, 링크, 히스토리)

### 비주얼 톤 (Notion 스타일)
- 미니멀한 색상 체계, 높은 가독성, 넉넉한 여백
- 컴포넌트는 단순하지만 정보 계층은 명확하게
- 과도한 장식보다 "읽기/스캔 속도" 우선

## 7. 핵심 사용자 시나리오
### 시나리오 A: 에이전트 팀 초기 구성
1. 사용자가 워크스페이스 생성
2. "멤버 추가"에서 AI 에이전트 생성 (이름, 역할, 책임, 말투, 툴 권한)
3. 프로필 이미지 자동 생성
4. 기본 채널(`general`, `planning`, `execution`) 자동 생성

### 시나리오 B: DM으로 업무 지시
1. 사용자가 특정 에이전트와 DM 시작
2. "작업 카드" 형태로 업무 지시 (목표, 산출물, 마감일)
3. 에이전트가 진행 상태를 단계별 보고
4. 완료 시 결과물 + 근거 링크 + 다음 액션 제안

### 시나리오 C: 채널 협업
1. 여러 에이전트를 채널에 초대
2. 사용자/에이전트가 이슈를 실시간 논의
3. 메시지를 작업으로 전환하고 담당 에이전트 지정
4. 작업 완료까지 상태 변화가 타임라인에 기록

## 8. 기능 요구사항 (MVP)
### 8.1 멤버 관리
- 에이전트 CRUD: 생성/수정/삭제
- 필수 필드: 이름, Role, 책임 범위, 기본 지시 프롬프트
- 선택 필드: 전문분야 태그, 응답 톤, 금지 작업, 툴 접근 권한
- 프로필 이미지 자동 생성 (프롬프트 기반)

### 8.2 DM
- 사용자 ↔ 에이전트 1:1 대화
- 메시지에서 작업 생성 (`/task` 또는 버튼)
- 작업 속성: 제목, 설명, 담당, 우선순위, 마감일, 상태
- 에이전트 응답에 "진행 로그" 블록 지원 (진행중/막힘/완료)

### 8.3 채널
- 채널 생성/수정/아카이브
- 채널별 에이전트 참여 관리
- 멘션(`@agent-name`)으로 명시적 호출
- 메시지 스레드 및 중요 메시지 고정
- 채널 내 작업 보드 뷰(간단 칸반: Todo/Doing/Done)

### 8.4 작업 관리(공통)
- DM/채널에서 생성된 작업을 단일 작업함에서 조회
- 상태 전이 규칙: Todo -> Doing -> Review -> Done
- 작업 이력(누가, 언제, 무엇을 변경했는지) 기록

### 8.5 에이전트 실행 엔진 (Codex CLI)
- 실행 방식: 서버/로컬 워커가 `codex exec` 호출
- 컨텍스트 유지: 에이전트별 `session_id` 저장 후 `codex exec resume <session_id>`로 이어서 실행
- 표준 플로우:
  1. 첫 호출 시 `codex exec --json "<prompt>"` 실행
  2. 이벤트에서 `session_id(thread_id)` 추출 후 DB 저장
  3. 후속 호출은 해당 ID로 resume
- 동시성 정책: 같은 에이전트(session)는 직렬 처리, 서로 다른 에이전트는 병렬 처리
- 충돌 방지: 코드 작업은 에이전트별 작업 디렉터리/브랜치(worktree) 분리 권장

## 9. IA (정보 구조)
- Workspace
- Members (AI Agents)
- DMs
- Channels
- Tasks
- Settings

## 10. 데이터 모델 (초안)
### Agent
- id
- name
- role
- system_prompt
- responsibilities
- tools
- avatar_url
- session_id (codex thread/session)
- execution_mode (`codex_exec`)
- created_at

### Conversation
- id
- type (`dm` | `channel`)
- title
- participant_ids
- created_at

### Message
- id
- conversation_id
- sender_type (`user` | `agent`)
- sender_id
- content
- thread_parent_id (optional)
- created_at

### Task
- id
- source_message_id
- title
- description
- assignee_agent_id
- status
- priority
- due_date
- created_at
- updated_at

## 11. 운영 정책 (MVP)
- 인증 정책: 앱 내부 OAuth 미구현, 사전 로그인된 Codex CLI 인증 상태 사용
- 실행 전제: 운영 머신에 Codex CLI 설치 + 1회 로그인 완료
- 에이전트 응답 타임아웃: 기본 60초
- 실패 시 재시도 1회 후 사용자에게 실패 원인 노출
- 삭제 정책: 대화/작업은 소프트 삭제
- 감사 로그: 멤버 설정 변경과 작업 상태 변경은 필수 기록
- 동시 실행 제한: 글로벌 워커 동시성 2~4부터 시작, 계정 한도 기반으로 조정

## 12. 성공 지표 (KPI)
- 활성 워크스페이스당 주간 작업 생성 수
- 작업 완료율(생성 대비 Done 비율)
- 평균 작업 리드타임(Todo -> Done)
- DM/채널 재방문율(7일 리텐션)
- 사용자 만족도(주간 간단 피드백 점수)

## 13. MVP 범위 요약
### 포함
- AI 에이전트 멤버 관리
- DM + 채널 메시징
- 메시지 기반 작업 생성/상태 추적
- 기본 검색(대화/작업 제목)
- `codex exec` 기반 에이전트 실행 및 에이전트별 session_id 컨텍스트 유지

### 제외 (v1 이후)
- 외부 서비스 연동(Drive, Jira, GitHub)
- 멀티 워크스페이스 고급 권한 체계
- 모바일 네이티브 앱
- 앱 자체 OAuth/멀티유저 인증 체계

## 14. 개발 로드맵 (예시: 6주)
- 1주차: IA/와이어프레임, 데이터 모델 확정
- 2주차: 워크스페이스/멤버 관리 + Codex CLI 실행 환경 구성
- 3주차: DM/채널 메시징 기본 기능 + `codex exec` 연동
- 4주차: 작업 카드 + 상태 전이 + session_id resume 처리
- 5주차: 에이전트 프로필/프롬프트 편집, 동시성/재시도 안정화
- 6주차: QA, 사용성 테스트, MVP 배포

## 15. 주요 리스크 및 대응
- 에이전트 응답 품질 편차
  - 대응: 역할 프롬프트 템플릿화, 샘플 시나리오 기반 평가
- 메시지량 증가 시 맥락 누락
  - 대응: 스레드 강제, 작업 단위 컨텍스트 요약
- 사용자 신뢰 부족
  - 대응: 모든 작업에 근거/출처/결정 로그 노출
- 계정 사용량 한도 도달
  - 대응: 호출 큐잉, 동시성 제한, 우선순위 기반 실행

## 16. 다음 버전(v1) 확장 아이디어
- 외부 툴 연동 (캘린더, 문서, 코드 저장소)
- 자동 스탠드업/주간 리포트 생성
- 에이전트 간 협업 플로우 자동화 (체인 실행)
- 채널별 목표/OKR 연동 대시보드
- API 백엔드 추상화(실행 인터페이스 고정 후 OpenAI API 경로로 스위치)
